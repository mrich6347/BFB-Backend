{
  "name": "Cash Transaction with Assignment Then Update Test",
  "description": "Create budget, cash account, category, do transaction without initial assignment, assign money to cover overspending, then update transaction from outflow to inflow and verify final state",
  "steps": [
    {
      "action": "create_budget",
      "description": "Create test budget",
      "params": {
        "name": "Test Budget",
        "currency": "USD",
        "currency_placement": "BEFORE",
        "date_format": "US_SLASH",
        "number_format": "DOT_COMMA"
      }
    },
    {
      "action": "create_account",
      "description": "Create checking account with $1000",
      "params": {
        "name": "Checking",
        "account_type": "CASH",
        "account_balance": 1000
      }
    },
    {
      "action": "create_category_group",
      "description": "Create category group",
      "params": {
        "name": "Monthly Expenses"
      }
    },
    {
      "action": "create_category",
      "description": "Create groceries category",
      "params": {
        "name": "Groceries",
        "category_group_name": "Monthly Expenses"
      }
    },
    {
      "action": "create_transaction",
      "description": "Spend $50 on groceries without prior assignment",
      "params": {
        "account_name": "Checking",
        "payee": "Store",
        "category_name": "Groceries",
        "amount": -50,
        "date": "2025-06-14"
      }
    },
    {
      "action": "assign_money",
      "description": "Assign $50 to groceries to cover the overspending",
      "params": {
        "category_name": "Groceries",
        "amount": 50
      }
    },
    {
      "action": "update_transaction",
      "description": "Update the transaction from -$50 outflow to +$50 inflow",
      "params": {
        "payee": "Store",
        "amount": 50
      }
    },
    {
      "action": "move_money_to_ready_to_assign",
      "description": "Move the $100 available from category to Ready to Assign",
      "params": {
        "category_name": "Groceries",
        "amount": 100
      }
    },
    {
      "action": "get_state",
      "description": "Check state after moving money"
    },
    {
      "action": "delete_transaction",
      "description": "Delete the transaction",
      "params": {
        "payee": "Store"
      }
    }
  ],
  "expectedFinalState": {
    "readyToAssign": 1050,
    "accounts": {
      "Checking": {
        "working_balance": 1000
      }
    },
    "categories": {
      "Groceries": {
        "assigned": -50,
        "activity": 0,
        "available": -50
      }
    }
  },
  "ynabBehaviorNotes": [
    "Transaction creates overspending: assigned=0, activity=-50, available=-50",
    "Assigning $50 covers the overspending: assigned=50, activity=-50, available=0",
    "Updating transaction from -$50 to +$50 changes activity from -50 to +50",
    "Final category state: assigned=50, activity=+50, available=100",
    "Account working balance: $1000 + $50 (inflow) = $1050",
    "Ready to Assign remains at $950 (assignment stays in place)",
    "Moving $100 to Ready to Assign: assigned=-50, activity=+50, available=0",
    "Ready to Assign becomes: $950 + $100 = $1050",
    "Deleting transaction removes activity: assigned=-50, activity=0, available=-50",
    "Final account working balance: $1000 (transaction deleted)",
    "Final Ready to Assign: $1050, Final category: assigned=-50, activity=0, available=-50"
  ]
}
